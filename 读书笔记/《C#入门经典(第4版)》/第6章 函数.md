# 第6章 函数

到目前为止，我们所看到的代码都是以单个代码块的形式出现的，其中包含一些重复执行的循环代码，以及有条件地执行的分支语句。如果要对数据执行某种操作，就应把所需要的代码放在合适的地方。

这种代码结构的作用是有限的。某些任务常常需要在一个程序中执行好几次，例如，查找数组中的最大值。此时可以把相同（或几乎相同）的代码块按照需要放在应用程序中，但这样做也会存在问题。在某个常见任务中，即使进行非常小的改动（例如，修改某个代码错误），也需要修改多个代码块，这些代码块可能分布在整个应用程序中。如果忘了修改其中的一个代码块，就会产生很大的影响，导致整个应用程序失败。另外，应用程序也比较常。

这个问题的解决方法是使用函数。在C#中，函数是一种方法，可提供在应用程序中的任何一处执行的代码块。

> **提示：**
>
> 本章介绍的特定类型的函数称为方法。但是，这个术语在.NET编程中有非常特殊的含义，本书后面会详细讨论它，所以现在不使用这个术语。

例如，有一个函数返回数组中的最大值，可以在代码的任何位置使用这个函数，且在每个地方都使用相同的代码行。因为只需要提供一次这段代码，所以对代码的任何修改都只影响使用该函数进行的计算。这个函数可以看作包含可重用的代码。

函数还可以使代码的可读性更高，因为可以使用函数把相关的代码组合在一起。如果这么做，应用程序主体就会非常短，因为代码的内部工作被分散了。这类似于在IDE中使用大纲视图把代码分解为各个区域，应用程序就会得到更富有逻辑的结构。

函数行可以用于创建多用途的代码，让它们对不同的数据执行相同的操作。可以以参数的形式为一个函数的提供信息，以返回值的形式得到函数的结果。在上面的示例中，参数就是一个要搜索的数组，而返回值就是数组中的最大值。这意味着每次可以使用同一个函数处理不同的数组。函数的参数和返回值共同定义了函数的签名。

**本章的主要内容：**

* 定义和使用不接受或返回任何数据的简单函数。
* 介绍在函数之间传送数据的方式。
* 讨论变量作用域的问题，这涉及到C#应用程序中如何把数据定位到特定的代码区域，在把代码分解到多个函数中时，这个问题特别重要。
* 深入探讨C#应用程序中的一个重要函数：Main()。论述如何使用这个函数的内置功能来利用命名行参数，以便在运行应用程序时，把信息传送给它们。
* 讨论第5章介绍的结构类型的另一个特性，即可以把函数作为结构类型的成员。

最后探讨两个比较高级的主题：函数的重载和委托。函数重载技术可以提供名称相同但签名不同的多个函数。委托是一种变量类型，可以间接地使用函数。同一个委托可调用返回类型和参数都匹配的任何函数，在运行期间在几个函数之间进行选择。

## 6.6 委托

委托是一种可以把引用存储为函数的类型。

## 6.7 小结

本章相当全面地介绍了C#代码中函数的使用。函数提供的许多其他特性（特别是委托）比较抽象，我们将在第8章的面向对象编程中讨论它们。

本章的主要内容总结如下：

* 在控制台应用程序中定义和使用函数
* 通过返回值和参数，与函数交换数据
* 给函数传送参数数组
* 按引用或按值传递参数
* 为其他返回值指定参数
* 变量作用域的概念，变量在不需要它们的代码块中可以隐藏起来
* Main()函数的细节，包括命令行参数的用法
* 在结构类型中使用函数
* 函数的重载，可以为同一个函数提供不同的参数，获得其他功能
* 委托以及如何在运行期间动态地选择函数

如何使用函数的知识是将来要完成的所有编程工作的核心。后面的章节，特别是学习OOP（从第8章开始）的部分，将介绍函数的形式结构，以及如何把它们应用于类。从现在开始i，把代码放在可重用块中将成为C#编程中最有用的部分。